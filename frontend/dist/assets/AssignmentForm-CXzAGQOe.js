import{i as E,x as I,s as L,H as q,o as C,a0 as F,V as T,y as N,A as u,w as B,a as y,u as M,b as P,d as R,e as v,f as a,g as i,k as o,h as U,j as $,m as d,_ as w,n as c,t as m,p as k,aw as j,F as K}from"./index-OSkjyhkw.js";import{_ as O}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DdVHL6EX.js";const z={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},H={class:"space-x-2"},Q={class:"w-3/4 mx-auto py-5"},G={class:"font-semibold mb-4"},J={class:"grid grid-cols-2 gap-5 mt-4 mb-8"},W={class:"text-xs text-ink-gray-5 mb-2"},Z={__name:"AssignmentForm",props:{assignmentID:{type:String,required:!0}},setup(x){const _=E("$user"),p=I(),{brand:D}=L(),l=x,n=q({title:"",type:"PDF",question:""});C(()=>{var e,s;l.assignmentID=="new"&&!((e=_.data)!=null&&e.is_moderator)&&!((s=_.data)!=null&&s.is_instructor)&&p.push({name:"Courses"}),l.assignmentID!=="new"&&t.reload(),window.addEventListener("keydown",g)});const g=e=>{e.key==="s"&&(e.ctrlKey||e.metaKey)&&(b(),e.preventDefault())};T(()=>{window.removeEventListener("keydown",g)});const t=F({doctype:"LMS Assignment",name:l.assignmentID,auto:!1}),A=N({url:"frappe.client.insert",makeParams(e){return{doc:{doctype:"LMS Assignment",...e}}},onSuccess(e){p.push({name:"AssignmentForm",params:{assignmentID:e.name}})},onError(e){var s;u(__("Error"),__(((s=e.messages)==null?void 0:s[0])||e),"x")}}),b=()=>{l.assignmentID=="new"?A.submit({...n}):t.setValue.submit({...n},{onSuccess(e){u(__("Success"),__("Assignment saved successfully"),"check"),t.reload()},onError(e){var s;u(__("Error"),__(((s=e.messages)==null?void 0:s[0])||e),"x")}})};B(t,()=>{Object.keys(t.doc).forEach(e=>{n[e]=t.doc[e]})});const S=y(()=>[{label:__("Assignments"),route:{name:"Assignments"}},{label:t.doc?t.doc.title:__("New Assignment")}]),V=y(()=>[{label:"PDF",value:"PDF"},{label:"Image",value:"Image"},{label:"Document",value:"Document"},{label:"Text",value:"Text"},{label:"URL",value:"URL"}]);return M(()=>({title:t.doc?t.doc.title:__("New Assignment"),icon:D.favicon})),(e,s)=>{var f;const h=P("router-link");return v(),R(K,null,[a("header",z,[i(o(O),{items:S.value},null,8,["items"]),a("div",H,[(f=o(t).doc)!=null&&f.name?(v(),U(h,{key:0,to:{name:"AssignmentSubmissionList",query:{assignmentID:o(t).doc.name}}},{default:d(()=>[i(o(w),null,{default:d(()=>[c(m(e.__("Submission List")),1)]),_:1})]),_:1},8,["to"])):$("",!0),i(o(w),{variant:"solid",onClick:s[0]||(s[0]=r=>b())},{default:d(()=>[c(m(e.__("Save")),1)]),_:1})])]),a("div",Q,[a("div",G,m(e.__("Details")),1),a("div",J,[i(o(k),{modelValue:n.title,"onUpdate:modelValue":s[1]||(s[1]=r=>n.title=r),label:e.__("Title"),required:!0},null,8,["modelValue","label"]),i(o(k),{modelValue:n.type,"onUpdate:modelValue":s[2]||(s[2]=r=>n.type=r),type:"select",options:V.value,label:e.__("Type"),required:!0},null,8,["modelValue","options","label"])]),a("div",null,[a("div",W,[c(m(e.__("Question"))+" ",1),s[4]||(s[4]=a("span",{class:"text-ink-red-3"},"*",-1))]),i(o(j),{content:n.question,onChange:s[3]||(s[3]=r=>n.question=r),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])])])],64)}}};export{Z as default};
