import{r as m,s as D,i as v,x as S,o as $,y as j,Y as h,a as Y,u as B,d,e as i,f as a,g as L,k as s,t as n,h as E,j as R,F as V}from"./index-OSkjyhkw.js";import{_ as F}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DdVHL6EX.js";import{_ as I}from"./UpcomingEvaluations-LBUQL3dD.js";const O={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},q={class:"p-5"},z={key:0},P={class:"text-lg text-ink-gray-9 font-semibold mb-1"},T={class:"text-ink-gray-9 text-sm"},U={class:"text-ink-gray-9 font-semibold"},A={class:"text-sm text-ink-gray-7 font-medium"},G={key:1},W={__name:"CourseCertification",props:{courseName:{type:String,required:!0}},setup(y){var f,_;const o=m(null),p=m(null),{brand:b}=D(),l=m([]),u=v("$user"),g=v("$dayjs"),C=S(),t=y;$(()=>{k(),N()});const r=j({url:"frappe.client.get_value",params:{doctype:"LMS Certificate",filters:{member:(f=u.data)==null?void 0:f.name,course:t.courseName},fieldname:["name","template","issue_date"]},cache:[(_=u.data)==null?void 0:_.name,t.courseName]}),k=()=>{var e;h("frappe.client.get_value",{doctype:"LMS Enrollment",filters:{member:(e=u.data)==null?void 0:e.name,course:t.courseName},fieldname:["purchased_certificate"]}).then(c=>{c.purchased_certificate?r.reload():C.push({name:"CourseDetail",params:{courseName:t.courseName}})})},N=()=>{h("frappe.client.get_value",{doctype:"LMS Course",filters:{name:t.courseName},fieldname:["title","evaluator"]}).then(e=>{o.value=e.title,p.value=e.evaluator,x()})},x=()=>{l.value=[{course:t.courseName,title:o.value,evaluator:p.value}]},M=e=>{window.open(`/api/method/frappe.utils.print_format.download_pdf?doctype=LMS+Certificate&name=${e.name}&format=${encodeURIComponent(e.template)}`,"_blank")},w=Y(()=>[{label:__("Courses"),route:{name:"Courses"}},{label:o.value,route:{name:"CourseDetail",params:{courseName:t.courseName}}},{label:__("Certification")}]);return B(()=>({title:o.value,icon:b.favicon})),(e,c)=>(i(),d(V,null,[a("header",O,[L(s(F),{class:"h-7",items:w.value},null,8,["items"])]),a("div",q,[s(r).data&&Object.keys(s(r).data).length?(i(),d("div",z,[a("div",P,n(e.__("Certification")),1),a("div",T,n(e.__("You are already certified for this course. Click on the card below to open your certificate.")),1),a("div",{class:"border p-3 w-fit min-w-60 rounded-md space-y-2 hover:bg-surface-gray-1 cursor-pointer mt-5",onClick:c[0]||(c[0]=H=>M(s(r).data))},[a("div",U,n(o.value),1),a("div",A,n(e.__("Issued On"))+": "+n(s(g)(s(r).data.issue_date).format("DD MMM YYYY")),1)])])):(i(),d("div",G,[l.value.length?(i(),E(I,{key:0,courses:l.value},null,8,["courses"])):R("",!0)]))])],64))}};export{W as default};
