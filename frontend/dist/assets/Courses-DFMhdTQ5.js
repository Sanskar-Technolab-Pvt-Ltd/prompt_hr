import{i as V,r as m,s as A,o as I,c as G,w as H,a as $,u as J,b as W,d as b,e as v,f as n,g as u,h as w,j as C,k as a,l as X,m as y,_ as S,n as F,t as x,P as Z,p as L,q as ee,F as N,v as te,B as le}from"./index-OSkjyhkw.js";import{_ as ae}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DdVHL6EX.js";import{T as se}from"./TabButtons-B08mECax.js";import{_ as oe}from"./CourseCard-C76vmRuF.js";import"./UserAvatar-CL8ZQPT_.js";import"./CourseInstructors-DK5TxlK3.js";import"./ProgressBar-Bazu_17j.js";const ie={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},re={class:"p-5 pb-10"},ne={class:"flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:items-center justify-between mb-5"},ue={class:"text-lg text-ink-gray-9 font-semibold"},de={class:"flex flex-col space-y-2 lg:space-y-0 lg:flex-row lg:items-center lg:space-x-4"},ce={class:"grid grid-cols-2 gap-2"},me={class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40"},ve={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-5"},pe={key:1,class:"flex flex-col items-center justify-center text-sm text-ink-gray-5 italic mt-48"},ge={class:"text-lg font-medium mb-1"},fe={class:"leading-5 w-2/5 text-center"},_e={key:2,class:"flex justify-center mt-5"},$e={__name:"Courses",setup(he){var k;const d=V("$user"),j=V("$dayjs"),T=m(0),U=m(30),p=m([]),g=m(null),f=m(""),_=m(!1),l=m({}),r=m("Live"),{brand:B}=A();I(()=>{P(),h(),p.value=[{label:"",value:null}]});const P=()=>{let t=new URLSearchParams(location.search);f.value=t.get("title")||"",g.value=t.get("category")||null,_.value=t.get("certification")||!1},c=G({doctype:"LMS Course",url:"lms.lms.utils.get_courses",cache:["courses",(k=d.data)==null?void 0:k.name],pageLength:U.value,start:T.value,onSuccess(t){let e=t.map(s=>s.category);e=e.filter((s,i)=>e.indexOf(s)===i&&s),p.value.length<=e.length&&z(t)}}),h=()=>{E(),c.update({filters:l.value}),c.reload()},E=()=>{M(),q(),D(),Y(),O(),R()},M=()=>{g.value?l.value.category=g.value:delete l.value.category},q=()=>{f.value?l.value.title=["like",`%${f.value}%`]:delete l.value.title},D=()=>{_.value?l.value.certification=1:delete l.value.certification},Y=()=>{var t;delete l.value.live,delete l.value.created,delete l.value.published_on,delete l.value.upcoming,r.value=="Enrolled"&&((t=d.data)!=null&&t.is_student)?(l.value.enrolled=1,delete l.value.published):(delete l.value.published,delete l.value.enrolled,r.value=="Live"?(l.value.published=1,l.value.upcoming=0,l.value.live=1):r.value=="Upcoming"?(l.value.upcoming=1,l.value.published=1):r.value=="New"?(l.value.published=1,l.value.published_on=[">=",j().add(-3,"month").format("YYYY-MM-DD")]):r.value=="Created"&&(l.value.created=1))},O=()=>{var t;(!d.data||(t=d.data)!=null&&t.is_student&&r.value!="Enrolled")&&(l.value.published=1)},R=()=>{let t=new URLSearchParams(location.search),e={title:f.value,category:g.value,certification:_.value};Object.keys(e).forEach(i=>{e[i]?t.set(i,e[i]):t.delete(i)});let s="";t.toString()&&(s=`?${t.toString()}`),history.replaceState({},"",`${location.pathname}${s}`)},z=t=>{t.forEach(e=>{e.category&&!p.value.find(s=>s.value===e.category)&&p.value.push({label:e.category,value:e.category})})};H(r,()=>{h()});const K=$(()=>{var e,s,i;let t=[{label:__("Live")},{label:__("New")},{label:__("Upcoming")}];return(e=d.data)!=null&&e.is_moderator||(s=d.data)!=null&&s.is_instructor||(i=d.data)!=null&&i.is_evaluator?t.push({label:__("Created")}):d.data&&t.push({label:__("Enrolled")}),t}),Q=$(()=>[{label:__("Courses"),route:{name:"Courses"}}]);return J(()=>({title:__("Courses"),icon:B.favicon})),(t,e)=>{var i;const s=W("router-link");return v(),b(N,null,[n("header",ie,[u(a(ae),{items:Q.value},null,8,["items"]),a(X)()?(v(),w(s,{key:0,to:{name:"CourseForm",params:{courseName:"new"}}},{default:y(()=>[u(a(S),{variant:"solid"},{prefix:y(()=>[u(a(Z),{class:"h-4 w-4 stroke-1.5"})]),default:y(()=>[F(" "+x(t.__("New")),1)]),_:1})]),_:1})):C("",!0)]),n("div",re,[n("div",ne,[n("div",ue,x(t.__("All Courses")),1),n("div",de,[u(a(se),{buttons:K.value,modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o)},null,8,["buttons","modelValue"]),u(a(L),{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=o=>_.value=o),label:t.__("Certification"),type:"checkbox",onChange:e[2]||(e[2]=o=>h())},null,8,["modelValue","label"]),n("div",ce,[u(a(L),{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=o=>f.value=o),placeholder:t.__("Search by Title"),type:"text",class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40",onInput:e[4]||(e[4]=o=>h())},null,8,["modelValue","placeholder"]),n("div",me,[p.value.length?(v(),w(a(ee),{key:0,modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=o=>g.value=o),options:p.value,placeholder:t.__("Category"),onChange:e[6]||(e[6]=o=>h())},null,8,["modelValue","options","placeholder"])):C("",!0)])])])]),(i=a(c).data)!=null&&i.length?(v(),b("div",ve,[(v(!0),b(N,null,te(a(c).data,o=>(v(),w(s,{to:{name:"CourseDetail",params:{courseName:o.name}}},{default:y(()=>[u(oe,{course:o},null,8,["course"])]),_:2},1032,["to"]))),256))])):a(c).list.loading?C("",!0):(v(),b("div",pe,[u(a(le),{class:"size-10 mx-auto stroke-1 text-ink-gray-4"}),n("div",ge,x(t.__("No courses found")),1),n("div",fe,x(t.__("There are no courses matching the criteria. Keep an eye out, fresh learning experiences are on the way soon!")),1)])),!a(c).list.loading&&a(c).hasNextPage?(v(),b("div",_e,[u(a(S),{onClick:e[7]||(e[7]=o=>a(c).next())},{default:y(()=>[F(x(t.__("Load More")),1)]),_:1})])):C("",!0)])],64)}}};export{$e as default};
