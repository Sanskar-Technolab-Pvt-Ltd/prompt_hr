import{D as N,r as F,E as D,i as S,y as M,h as V,e as p,m as c,f as s,d as b,t as i,g as n,k as e,b1 as R,_ as g,n as $,b2 as B,b3 as E,J as Y,K as z,s as q,u as O,b as H,j,bI as K,bJ as W,bK as I,bL as G,bM as Q,bN as X,bO as Z,bP as ee,M as se}from"./index-OSkjyhkw.js";import{_ as te}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DdVHL6EX.js";const ae={class:"flex flex-col gap-4"},oe={key:0},ie={class:""},ne={key:1,class:"flex items-center"},le={class:"border rounded-md p-2 mr-2"},re={class:"flex flex-col"},de={class:"text-sm text-ink-gray-4 mt-1"},ce={__name:"JobApplicationModal",props:N({job:{type:String,required:!0}},{modelValue:{},modelModifiers:{},application:{},applicationModifiers:{}}),emits:["update:modelValue","update:application"],setup(x){const d=F(null),k=D(x,"modelValue"),C=S("$user"),h=D(x,"application"),w=x,a=u=>{if(u.name.split(".").pop().toLowerCase()!="pdf")return"Only PDF file is allowed"},m=M({url:"frappe.client.insert",makeParams(u){var r,l;return{doc:{doctype:"LMS Job Application",user:(r=C.data)==null?void 0:r.name,resume:(l=d.value)==null?void 0:l.file_name,job:w.job}}}}),y=u=>{m.submit({},{validate(){if(!d.value)return"Please upload your resume"},onSuccess(){z({title:"Success",text:"Your application has been submitted",icon:"check",iconClasses:"bg-surface-green-3 text-ink-white rounded-md p-px"}),h.value.reload(),u()},onError(r){var l;z({title:"Error",text:((l=r.messages)==null?void 0:l[0])||r,icon:"x",iconClasses:"bg-surface-red-5 text-ink-white rounded-md p-px",position:"top-center",timeout:10})}})};return(u,r)=>(p(),V(e(Y),{modelValue:k.value,"onUpdate:modelValue":r[1]||(r[1]=l=>k.value=l),class:"text-base",options:{title:u.__("Apply for this job"),size:"lg",actions:[{label:"Submit",variant:"solid",onClick:l=>{y(l)}}]}},{"body-content":c(()=>[s("div",ae,[s("p",null,i(u.__("Submit your resume to proceed with your application for this position. Upon submission, it will be shared with the job poster.")),1),d.value?(p(),b("div",ne,[s("div",le,[n(e(B),{class:"h-5 w-5 stroke-1.5 text-ink-gray-7"})]),s("div",re,[s("span",null,i(d.value.file_name),1),s("span",de,i(e(E)(d.value.file_size)),1)])])):(p(),b("div",oe,[n(e(R),{fileTypes:[".pdf"],validateFile:a,onSuccess:r[0]||(r[0]=l=>{d.value=l})},{default:c(({file:l,progress:o,uploading:t,openFileSelector:f})=>[s("div",ie,[n(e(g),{onClick:f,loading:t},{default:c(()=>[$(i(t?`Uploading ${o}%`:"Upload your resume"),1)]),_:2},1032,["onClick","loading"])])]),_:1})]))])]),_:1},8,["modelValue","options"]))}},pe={class:""},ue={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},me={key:0,class:"flex space-x-2"},_e={key:1},be={key:0,class:"max-w-3xl mx-auto"},fe={class:"p-4"},xe={class:"space-y-5 mb-10"},he={class:"flex items-center"},ye=["src","alt"],ve={class:"text-2xl text-ink-gray-9 font-semibold"},ge={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-10 gap-y-5 md:gap-y-5"},ke={class:"flex items-center space-x-4"},we={class:"flex flex-col space-y-1 text-ink-gray-7"},je={class:"text-xs text-ink-gray-5 font-medium uppercase"},Me={class:"text-sm font-semibold"},$e={class:"flex items-center space-x-4"},Ce={class:"flex flex-col space-y-1 text-ink-gray-7"},Se={class:"text-xs font-medium uppercase"},Ve={class:"text-sm font-semibold"},Ae={class:"flex items-center space-x-4"},Je={class:"flex flex-col space-y-1 text-ink-gray-7"},Pe={class:"text-xs font-medium uppercase"},Le={class:"text-sm font-semibold"},Te={class:"flex items-center space-x-4"},Ue={class:"flex flex-col space-y-1 text-ink-gray-7"},De={class:"text-xs font-medium uppercase"},ze={class:"text-sm font-semibold"},Fe={key:0,class:"flex items-center space-x-4"},Ne={class:"flex flex-col space-y-1 text-ink-gray-7"},Re={class:"text-xs font-medium uppercase"},Be={class:"text-sm font-semibold"},Ee=["innerHTML"],Oe={__name:"JobDetail",props:{job:{type:String,required:!0}},setup(x){const d=S("$user"),k=S("$dayjs"),{brand:C}=q(),h=F(!1),w=x,a=M({url:"lms.lms.api.get_job_details",params:{job:w.job},cache:["job",w.job],auto:!0,onSuccess:o=>{var t;(t=d.data)!=null&&t.name&&m.submit(),y.submit()}}),m=M({url:"frappe.client.get_list",makeParams(o){var t,f;return{doctype:"LMS Job Application",filters:{job:(t=a.data)==null?void 0:t.name,user:(f=d.data)==null?void 0:f.name}}}}),y=M({url:"frappe.client.get_count",makeParams(o){var t;return{doctype:"LMS Job Application",filters:{job:(t=a.data)==null?void 0:t.name}}}}),u=()=>{h.value=!0},r=o=>{window.location.href=`/login?redirect-to=/job-openings/${o}`},l=o=>{window.open(o,"_blank")};return O(()=>{var o;return{title:(o=a.data)==null?void 0:o.job_title,icon:C.favicon}}),(o,t)=>{var A,J,P,L,T,U;const f=H("router-link");return p(),b("div",pe,[s("header",ue,[n(e(te),{class:"h-7",items:[{label:o.__("Jobs"),route:{name:"Jobs"}},{label:(A=e(a).data)==null?void 0:A.job_title,route:{name:"JobDetail",params:{job:(J=e(a).data)==null?void 0:J.name}}}]},null,8,["items"]),(P=e(d).data)!=null&&P.name?(p(),b("div",me,[e(d).data.name==((L=e(a).data)==null?void 0:L.owner)?(p(),V(f,{key:0,to:{name:"JobCreation",params:{jobName:(T=e(a).data)==null?void 0:T.name}}},{default:c(()=>[n(e(g),null,{prefix:c(()=>[n(e(K),{class:"h-4 w-4 stroke-1.5"})]),default:c(()=>[$(" "+i(o.__("Edit")),1)]),_:1})]),_:1},8,["to"])):j("",!0),n(e(g),{onClick:t[0]||(t[0]=_=>{var v;return l((v=e(a).data)==null?void 0:v.company_website)})},{prefix:c(()=>[n(e(W),{class:"h-4 w-4 stroke-1.5"})]),default:c(()=>[$(" "+i(o.__("Visit Website")),1)]),_:1}),(U=e(m).data)!=null&&U.length?j("",!0):(p(),V(e(g),{key:1,variant:"solid",onClick:t[1]||(t[1]=_=>u())},{prefix:c(()=>[n(e(I),{class:"h-4 w-4"})]),default:c(()=>[$(" "+i(o.__("Apply")),1)]),_:1}))])):(p(),b("div",_e,[n(e(g),{onClick:t[2]||(t[2]=_=>{var v;return r((v=e(a).data)==null?void 0:v.name)})},{default:c(()=>[s("span",null,i(o.__("Login to apply")),1)]),_:1})]))]),e(a).data?(p(),b("div",be,[s("div",fe,[s("div",xe,[s("div",he,[s("img",{src:e(a).data.company_logo,class:"w-16 h-16 rounded-lg object-contain cursor-pointer mr-4",alt:e(a).data.company_name,onClick:t[3]||(t[3]=_=>l(e(a).data.company_website))},null,8,ye),s("div",ve,i(e(a).data.job_title),1)]),s("div",null,[s("div",ge,[s("div",ke,[n(e(G),{class:"h-4 w-4 text-ink-green-2"}),s("div",we,[s("span",je,i(o.__("Organisation")),1),s("span",Me,i(e(a).data.company_name),1)])]),s("div",$e,[n(e(Q),{class:"size-4 text-ink-red-3"}),s("div",Ce,[s("span",Se,i(o.__("Location")),1),s("span",Ve,i(e(a).data.location),1)])]),s("div",Ae,[n(e(X),{class:"h-4 w-4 text-yellow-500"}),s("div",Je,[s("span",Pe,i(o.__("Category")),1),s("span",Le,i(e(a).data.type),1)])]),s("div",Te,[n(e(Z),{class:"h-4 w-4 text-ink-blue-2"}),s("div",Ue,[s("span",De,i(o.__("Posted on")),1),s("span",ze,i(e(k)(e(a).data.creation).format("DD MMM YYYY")),1)])]),e(y).data?(p(),b("div",Fe,[n(e(ee),{class:"h-4 w-4 text-purple-500"}),s("div",Ne,[s("span",Re,i(o.__("Applications Received")),1),s("span",Be,i(e(y).data),1)])])):j("",!0)])])]),s("p",{innerHTML:e(a).data.description,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-6"},null,8,Ee)]),n(ce,{modelValue:h.value,"onUpdate:modelValue":t[4]||(t[4]=_=>h.value=_),application:e(m),"onUpdate:application":t[5]||(t[5]=_=>se(m)?m.value=_:null),job:e(a).data.name},null,8,["modelValue","application","job"])])):j("",!0)])}}};export{Oe as default};
