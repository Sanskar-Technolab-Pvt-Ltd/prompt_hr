import{d,e as o,f as n,j as v,t as i,n as F,g as h,k as s,a1 as X,a2 as M,a3 as Z,F as L,v as E,h as B,L as ee,i as T,s as te,r as f,a as Y,o as ae,c as se,w as le,u as oe,b as ne,m as w,_ as N,P as re,p as P,q as ie,B as ce}from"./index-OSkjyhkw.js";import{_ as ue}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DdVHL6EX.js";import{T as de}from"./TabButtons-B08mECax.js";import{_ as me}from"./DateRange-CgTlKDFZ.js";import{_ as he}from"./CourseInstructors-DK5TxlK3.js";import{_ as ve}from"./UserAvatar-CL8ZQPT_.js";const fe={class:"flex flex-col border-2 hover:bg-surface-gray-2 rounded-md p-4 h-full",style:{"min-height":"150px"}},ge={class:"text-lg leading-5 font-semibold mb-2 text-ink-gray-9"},_e={key:0,class:"text-xs bg-green-100 text-green-700 self-start px-2 py-0.5 rounded-md"},be={key:0},ye={key:1},pe={key:1,class:"text-xs bg-red-100 text-red-700 self-start px-2 py-0.5 rounded-md"},xe={class:"short-introduction text-sm text-ink-gray-7"},ke={key:2,class:"font-semibold text-ink-gray-9 mb-4"},$e={class:"flex flex-col space-y-2 mt-auto"},we={class:"flex items-center text-sm text-ink-gray-7"},Be={key:0,class:"flex items-center text-sm text-ink-gray-7"},Ce={key:3,class:"flex avatar-group overlap mt-4"},Ve={__name:"BatchCard",props:{batch:{type:Object,default:null}},setup(a){return(c,C)=>{var V;return o(),d("div",fe,[n("div",ge,i(a.batch.title),1),a.batch.seat_count&&a.batch.seats_left>0?(o(),d("div",_e,[F(i(a.batch.seats_left)+" ",1),a.batch.seats_left>1?(o(),d("span",be,i(c.__("Seats Left")),1)):a.batch.seats_left==1?(o(),d("span",ye,i(c.__("Seat Left")),1)):v("",!0)])):a.batch.seat_count&&a.batch.seats_left<=0?(o(),d("div",pe,i(c.__("Sold Out")),1)):v("",!0),n("div",xe,i(a.batch.description),1),a.batch.amount?(o(),d("div",ke,i(a.batch.price),1)):v("",!0),n("div",$e,[h(me,{startDate:a.batch.start_date,endDate:a.batch.end_date,class:"text-sm text-ink-gray-7"},null,8,["startDate","endDate"]),n("div",we,[h(s(X),{class:"h-4 w-4 stroke-1.5 mr-2 text-ink-gray-7"}),n("span",null,i(s(M)(a.batch.start_time))+" - "+i(s(M)(a.batch.end_time)),1)]),a.batch.timezone?(o(),d("div",Be,[h(s(Z),{class:"h-4 w-4 stroke-1.5 mr-2 text-ink-gray-5"}),n("span",null,i(a.batch.timezone),1)])):v("",!0)]),(V=a.batch.instructors)!=null&&V.length?(o(),d("div",Ce,[n("div",{class:ee(["h-6 mr-1",{"avatar-group overlap":a.batch.instructors.length>1}])},[(o(!0),d(L,null,E(a.batch.instructors,D=>(o(),B(ve,{user:D},null,8,["user"]))),256))],2),h(he,{instructors:a.batch.instructors},null,8,["instructors"])])):v("",!0)])}}},Se={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},De={class:"p-5 pb-10"},Ye={class:"flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:items-center justify-between mb-5"},Fe={class:"text-lg text-ink-gray-9 font-semibold"},Le={class:"flex flex-col space-y-2 lg:space-y-0 lg:flex-row lg:items-center lg:space-x-4"},Ue={class:"grid grid-cols-2 gap-2"},je={class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40"},Me={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5"},Te={key:1,class:"flex flex-col items-center justify-center text-sm text-ink-gray-5 mt-48"},Ne={class:"text-lg font-medium mb-1"},Pe={class:"leading-5 w-2/5 text-center"},Ee={key:2,class:"flex justify-center mt-5"},Qe={__name:"Batches",setup(a){var U;const c=T("$user"),C=T("$dayjs"),{brand:V}=te(),D=f(0),z=f(20),b=f([]),y=f(null),p=f(""),x=f(!1),l=f({}),S=Y(()=>{var t;return(t=c.data)==null?void 0:t.is_student}),g=f(S.value?"All":"Upcoming"),k=f("start_date");ae(()=>{A(),$(),b.value=[{label:"",value:null}]});const A=()=>{let t=new URLSearchParams(location.search);p.value=t.get("title")||"",y.value=t.get("category")||null,x.value=t.get("certification")||!1},_=se({doctype:"LMS Batch",url:"lms.lms.utils.get_batches",cache:["batches",(U=c.data)==null?void 0:U.name],pageLength:z.value,start:D.value,onSuccess(t){let e=t.map(r=>r.category);e=e.filter((r,m)=>e.indexOf(r)===m&&r),b.value.length<=e.length&&H(t)}}),$=()=>{O(),_.update({filters:l.value,orderBy:k.value}),_.reload()},O=()=>{q(),R(),K(),Q(),G(),I()},q=()=>{y.value?l.value.category=y.value:delete l.value.category},R=()=>{p.value?l.value.title=["like",`%${p.value}%`]:delete l.value.title},K=()=>{x.value?l.value.certification=1:delete l.value.certification},Q=()=>{k.value="start_date",c.data&&(g.value=="Enrolled"&&S.value?(l.value.enrolled=1,delete l.value.start_date,delete l.value.published,k.value="start_date desc"):S.value?delete l.value.enrolled:(delete l.value.start_date,delete l.value.published,k.value="start_date desc",g.value=="Upcoming"?(l.value.start_date=[">=",C().format("YYYY-MM-DD")],l.value.published=1,k.value="start_date"):g.value=="Archived"?l.value.start_date=["<=",C().format("YYYY-MM-DD")]:g.value=="Unpublished"&&(l.value.published=0)))},G=()=>{(!c.data||S.value&&g.value!="Enrolled")&&(l.value.start_date=[">=",C().format("YYYY-MM-DD")],l.value.published=1)},I=()=>{let t=new URLSearchParams(location.search),e={title:p.value,category:y.value,certification:x.value};Object.keys(e).forEach(m=>{e[m]?t.set(m,e[m]):t.delete(m)});let r="";t.toString()&&(r=`?${t.toString()}`),history.replaceState({},"",`${location.pathname}${r}`)},H=t=>{t.forEach(e=>{e.category&&!b.value.find(r=>r.value===e.category)&&b.value.push({label:e.category,value:e.category})})};le(g,()=>{$()});const J=Y(()=>{var e,r,m;let t=[{label:__("All")}];return(e=c.data)!=null&&e.is_moderator||(r=c.data)!=null&&r.is_instructor||(m=c.data)!=null&&m.is_evaluator?(t.push({label:__("Upcoming")}),t.push({label:__("Archived")}),t.push({label:__("Unpublished")})):c.data&&t.push({label:__("Enrolled")}),t}),W=Y(()=>[{label:__("Batches"),route:{name:"Batches"}}]);return oe(()=>({title:__("Batches"),icon:V.favicon})),(t,e)=>{var m,j;const r=ne("router-link");return o(),d(L,null,[n("header",Se,[h(s(ue),{items:W.value},null,8,["items"]),(m=s(c).data)!=null&&m.is_moderator?(o(),B(r,{key:0,to:{name:"BatchForm",params:{batchName:"new"}}},{default:w(()=>[h(s(N),{variant:"solid"},{prefix:w(()=>[h(s(re),{class:"h-4 w-4 stroke-1.5"})]),default:w(()=>[F(" "+i(t.__("New")),1)]),_:1})]),_:1})):v("",!0)]),n("div",De,[n("div",Ye,[n("div",Fe,i(t.__("All Batches")),1),n("div",Le,[s(c).data?(o(),B(s(de),{key:0,buttons:J.value,modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=u=>g.value=u)},null,8,["buttons","modelValue"])):v("",!0),h(s(P),{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=u=>x.value=u),label:t.__("Certification"),type:"checkbox",onChange:e[2]||(e[2]=u=>$())},null,8,["modelValue","label"]),n("div",Ue,[h(s(P),{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=u=>p.value=u),placeholder:t.__("Search by Title"),type:"text",class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40",onInput:e[4]||(e[4]=u=>$())},null,8,["modelValue","placeholder"]),n("div",je,[b.value.length?(o(),B(s(ie),{key:0,modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=u=>y.value=u),options:b.value,placeholder:t.__("Category"),onChange:e[6]||(e[6]=u=>$())},null,8,["modelValue","options","placeholder"])):v("",!0)])])])]),(j=s(_).data)!=null&&j.length?(o(),d("div",Me,[(o(!0),d(L,null,E(s(_).data,u=>(o(),B(r,{to:{name:"BatchDetail",params:{batchName:u.name}}},{default:w(()=>[h(Ve,{batch:u},null,8,["batch"])]),_:2},1032,["to"]))),256))])):s(_).list.loading?v("",!0):(o(),d("div",Te,[h(s(ce),{class:"size-10 mx-auto stroke-1 text-ink-gray-4"}),n("div",Ne,i(t.__("No batches found")),1),n("div",Pe,i(t.__("There are no batches matching the criteria. Keep an eye out, fresh learning experiences are on the way soon!")),1)])),!s(_).list.loading&&s(_).hasNextPage?(o(),d("div",Ee,[h(s(N),{onClick:e[7]||(e[7]=u=>s(_).next())},{default:w(()=>[F(i(t.__("Load More")),1)]),_:1})])):v("",!0)])],64)}}};export{Qe as default};
